{% extends 'webapp/base.html' %}
{% block content %}

<div class="container mt-5">
  <!-- Header with action button -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="mb-0">üßπ Cleaning Listings</h2>
    {% if user.role == 'cleaner' %}
      <a href="{% url 'cleaning_listing_create' %}" class="btn btn-success">+ Create New Listing</a>
    {% endif %}
  </div>

  <form method="get" class="mb-4 d-flex justify-content-center">
    <input type="text" name="q" class="form-control w-50 me-2" placeholder="Search by name..." value="{{ query|default:'' }}">
    <button type="submit" class="btn btn-primary">Search</button>
  </form>
  <!-- Table with border and hover effect -->
  <div class="table-responsive border rounded p-3 bg-white shadow-sm">
    <table class="table table-hover mb-0">
      <thead class="table-light">
        <tr>
          <th>Title</th>
          <th>Created By</th>
          <th>Price</th>
          <th>Views</th>
          <th>Rating ‚≠ê</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        {% for d in data %}
        <tr>
          <td>{{ d.listing.name }}</td>
          <td>{{ d.listing.cleaner.full_name }}</td>
          <td>${{ d.listing.price|floatformat:2 }}</td>
          <td>{{ d.views }}</td>
          <td>{{ d.rating }}</td>
          <td>
            <a href="{% url 'cleaning_listing_view' d.listing.id %}" class="btn btn-info btn-sm">View Details</a>
          </td>
        </tr>
        {% empty %}
        <tr>
          <td colspan="4" class="text-center text-muted">No listings available.</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

{% endblock %}
